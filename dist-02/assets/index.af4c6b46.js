var L=Object.defineProperty;var N=(t,e,s)=>e in t?L(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var C=(t,e,s)=>(N(t,typeof e!="symbol"?e+"":e,s),s);import{C as V,r as x,a as p,o as h,c as g,b as r,F as M,d as F,e as i,w as o,t as _,f as c,n as k,g as T,h as A,i as O}from"./vendor.6f53b071.js";const q=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))f(a);new MutationObserver(a=>{for(const n of a)if(n.type==="childList")for(const l of n.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&f(l)}).observe(document,{childList:!0,subtree:!0});function s(a){const n={};return a.integrity&&(n.integrity=a.integrity),a.referrerpolicy&&(n.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?n.credentials="include":a.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function f(a){if(a.ep)return;a.ep=!0;const n=s(a);fetch(a.href,n)}};q();const b=new V("ws://code.klsh.ru:8888/wss/connection/websocket");b.on("disconnect",function(t){console.log("CF disconnected",t)});b.on("connect",function(t){console.log("CF connected",t)});b.connect();class U{constructor(){C(this,"processNewMessage",e=>{let s=e.data;this.List.value.push({active:!1,data:s})});this.baseUrl="/api/staff",this.List=x([]),this.chan=null}async FetchList(){fetch("/api/staff/list").then(e=>e.json()).then(e=>{if(this.List.value.splice(0,this.List.value.length),Array.isArray(e))for(let s of e)this.List.value.push({active:!1,data:s})}),this.chan=b.subscribe("staff",this.processNewMessage)}async Update(e){let s=this.List.value.find(n=>n.active);switch(s.active=!1,s.data.options.readed=!1,s.data.options.deleted=!1,s.data.options.faworited=!1,e){case"read":s.data.options.readed=!0;break;case"delete":s.data.options.deleted=!0;break;case"faworite":s.data.options.faworited=!0;break}const a=await(await fetch("/api/staff/update",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({id:s.data.id,options:s.data.options})})).ok;console.log(a)}}const d=new U;d.FetchList();var y=(t,e)=>{for(const[s,f]of e)t[s]=f;return t};const j={props:["pane"],data(){return{activeCard:{},viewerVisible:!1}},watch:{pane(t,e){t!==e&&(this.viewerVisible=!1,this.activeCard={})}},computed:{list(){var t=[];switch(this.pane){case"0":t=d.List.value.filter(e=>e.data.options.readed==!1&&e.data.options.faworited==!1&&e.data.options.deleted==!1);break;case"1":t=d.List.value.filter(e=>e.data.options.readed==!0);break;case"2":t=d.List.value.filter(e=>e.data.options.faworited==!0);break;case"3":t=d.List.value.filter(e=>e.data.options.deleted==!0);break}return t.sort((e,s)=>e.data.id>s.data.id?-1:1)}},methods:{onClick(t){for(let e of this.list)e.active=!1;t.active=!0,this.activeCard=t.data.message,this.viewerVisible=!0},readMessage(){this.viewerVisible=!1,this.activeCard={},d.Update("read")},deleteMessage(){this.viewerVisible=!1,this.activeCard={},d.Update("delete")},faworiteMessage(){this.viewerVisible=!1,this.activeCard={},d.Update("faworite")}}},B={class:"question-view"},P={class:"list-complete"},S=["onClick"],E=r("i",{class:"el-icon-chat-line-round"},null,-1),I=c("\u0424\u0418\u041E: "),$=c("\u0414\u043E\u043B\u0436\u043D\u043E\u0441\u0442\u044C: "),H=c("\u041F\u043E\u0434\u0440\u0430\u0437\u0434\u0435\u043B\u0435\u043D\u0438\u0435: "),Q=c("\u0410\u0434\u0440\u0435\u0441 e-mail: "),R={class:"message-text"},W=c("\u041F\u043E\u043C\u0435\u0442\u0438\u0442\u044C \u043A\u0430\u043A \u043F\u0440\u043E\u0447\u0438\u0442\u0430\u043D\u043D\u043E\u0435"),z=c("\u041F\u043E\u043C\u0435\u0442\u0438\u0442\u044C \u043A\u0430\u043A \u0432\u044B\u0431\u0440\u0430\u043D\u043D\u043E\u0435"),D=c("\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0441\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u0435");function J(t,e,s,f,a,n){const l=p("el-col"),u=p("el-row"),m=p("el-divider"),w=p("el-button");return h(),g("div",B,[r("div",P,[(h(!0),g(M,null,F(n.list,v=>(h(),g("div",{onClick:ie=>n.onClick(v),key:v.id,class:k(["list-complete-item",{active:v.active}])},[r("div",null,[E,r("strong",null,_(v.data.message.name),1)]),r("div",null,"\u0414\u043E\u043B\u0436\u043D\u043E\u0441\u0442\u044C: "+_(v.data.message.position),1),r("div",null,"E-mail: "+_(v.data.message.email),1)],10,S))),128))]),r("div",{class:k(["message-viewer",{visible:!a.viewerVisible}])},[i(u,null,{default:o(()=>[i(l,{span:6},{default:o(()=>[I]),_:1}),i(l,{span:18},{default:o(()=>[r("strong",null,_(a.activeCard.name),1)]),_:1})]),_:1}),i(u,null,{default:o(()=>[i(l,{span:6},{default:o(()=>[$]),_:1}),i(l,{span:18},{default:o(()=>[c(_(a.activeCard.position),1)]),_:1})]),_:1}),i(u,null,{default:o(()=>[i(l,{span:6},{default:o(()=>[H]),_:1}),i(l,{span:18},{default:o(()=>[c(_(a.activeCard.department),1)]),_:1})]),_:1}),i(u,null,{default:o(()=>[i(l,{span:6},{default:o(()=>[Q]),_:1}),i(l,{span:18},{default:o(()=>[c(_(a.activeCard.email),1)]),_:1})]),_:1}),i(m),i(u,null,{default:o(()=>[r("div",R,_(a.activeCard.question),1)]),_:1}),i(m),i(u,null,{default:o(()=>[i(w,{type:"success",onClick:n.readMessage,round:""},{default:o(()=>[W]),_:1},8,["onClick"]),i(w,{type:"warning",onClick:n.faworiteMessage,round:""},{default:o(()=>[z]),_:1},8,["onClick"]),i(w,{type:"danger",onClick:n.deleteMessage,round:""},{default:o(()=>[D]),_:1},8,["onClick"])]),_:1})],2)])}var K=y(j,[["render",J]]);const G={components:{QuestionView:K},props:["msg"],data(){return{paneName:"0"}},methods:{onTabClick(t){for(let e of d.List.value)e.active=!1;this.paneName=t.paneName}}},X={class:"main-grid"},Y=r("div",{class:"grid-header"},[r("h1",null,"\u0421\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u044F:")],-1),Z={class:"grid-tabs"},ee=r("div",{class:"grid-footer"},null,-1);function te(t,e,s,f,a,n){const l=p("el-tab-pane"),u=p("el-tabs"),m=p("question-view");return h(),g("div",X,[Y,r("div",Z,[i(u,{type:"border-card",onTabClick:n.onTabClick},{default:o(()=>[i(l,{label:"\u041D\u043E\u0432\u044B\u0435"}),i(l,{label:"\u041F\u0440\u043E\u0447\u0438\u0442\u0430\u043D\u043D\u044B\u0435"}),i(l,{label:"\u0412\u044B\u0431\u0440\u0430\u043D\u043D\u044B\u0435"}),i(l,{label:"\u0423\u0434\u0430\u043B\u0435\u043D\u043D\u044B\u0435"})]),_:1},8,["onTabClick"])]),i(m,{pane:a.paneName,class:"grid-content"},null,8,["pane"]),ee])}var se=y(G,[["render",te]]);const ae={setup(t){return(e,s)=>(h(),T(se,{msg:"Test"}))}};A(ae).use(O).mount("#app");
